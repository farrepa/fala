{% extends "base.html" %}
{% load adviser_extras %}

{% block content %}
  <h1>Find a legal adviser or family mediator</h1>
  {% include 'adviser/partials/_find-legal-adviser.html' with data=data %}
  <form action="" method="GET">
    <fieldset>
      <legend>Search for a legal adviser or family mediator with a legal aid contract in England and Wales.</legend>
      <legend>Search by:</legend>
      <div class="form-group inline">
        {{ form.errors }}
      </div>
      <div class="form-group inline">
        {% for c in form.search_type %}
          <label class="block-label" for="search_type_{{ forloop.counter0 }}"><input id="search_type_{{ forloop.counter0 }}" name="search_type" type="radio" value="{{ c.choice_value }}" {{ form.search_type|checked:forloop.counter0 }}>{{ c.choice_label }}</input></label>
        {% endfor %}
      </div>
      <div class="panel-indent" data-control-value="location" data-controlled-by="search_type">
        <label class="form-label" for="postcode">Enter a postcode, town or city</label><input name="postcode" class="form-control" id="postcode" type="text" value="{{ form.postcode|val }}" />
      </div>
      <div class="panel-indent" data-control-value="organisation" data-controlled-by="search_type">
        <label class="form-label" for="organisation_name">Organisation name</label><input name="organisation_name" class="form-control" id="organisation_name" type="text" value="{{ form.organisation_name|val }}" />
      </div>
    </fieldset>

    <input class="button" type="submit" value="Search">

    <div data-control-value="location" data-controlled-by="search_type">
      <fieldset>
        <legend class="form-label-bold">Filter by:</legend>
        <p>
          Select all that apply
        </p>
        {% for c in form.organisation_types %}
          <label class="block-label" for="id_organisation_types_{{ forloop.counter0 }}"><input id="id_organisation_types_{{ forloop.counter0 }}" name="organisation_types" type="checkbox" value="{{ c.choice_value }}"{{ form.organisation_types|selected:forloop.counter0 }}>{{ c.choice_label }}</input></label>
        {% endfor %}
        <label class="block-label" for="category"><input id="category" name="category" type="checkbox" value="1"{% if form.category.value == '1' %} checked{% endif %}>Categories of law</input></label>
        <div class="panel-indent" data-control-value="1" data-controlled-by="category" data-persist-values="true">
          <div class="grid-row">
            <div class="column-half">
              {% for c in form.categories %}
                <label class="block-label" for="id_categories_{{ forloop.counter0 }}"><input id="id_categories_{{ forloop.counter0 }}" name="categories" type="checkbox" value="{{ c.choice_value }}"{{ form.categories|selected:forloop.counter0 }}>{{ c.choice_label }}</input></label>
                {% if forloop.counter0|multiply:2 >= categories|length %}
                  </div>
                  <div class="column-half">
                {% endif %}
              {% endfor %}
            </div>
          </div>
        </div>
      </fieldset>
    </div>
  </form>

  <div class="other-advise">
    <p id="advice">For advice on education or discrimination contact <a href="https://www.gov.uk/civil-legal-advice" rel="external" target="_blank">Civil Legal Advice.</a></p>
    <p>For welfare benefits, contact a <a href="https://www.justice.gov.uk/legal-aid/areas-of-work/civil/social-welfare-law" rel="external" target="_blank">local adviser</a>.</p>
  </div>

{% endblock %}

{% block include_js %}
  {{ block.super }}
  {% if data.results|length %}
    <script type="text/javascript" src="//maps.googleapis.com/maps/api/js?sensor=true"></script>
  {% endif%}
{% endblock %}
